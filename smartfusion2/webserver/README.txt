================================================================================
                    SmartFusion2 MSS MAC Web-server Demo With FreeRTOS and LwiP
================================================================================

This example project demonstrates the use of the SmartFusion2 Ethernet MAC(TBI)
connected to an SGMII Marvell PHY. It is targeted at the SmartFusion2 Eval kit.
It demonstrates the integration of the SmartFusion2 MAC driver with the lwIP 
TCP/IP stack and the FreeRTOS operating system.

--------------------------------------------------------------------------------
                            How to use this example
--------------------------------------------------------------------------------
This example project implements a simple web server running on SmartFusion2. It
includes a command line interface reporting the Ethernet link status, speed and
assigned IP address.

To use this example:
 - Connect the board to a DHCP capable switch or network.
 - Connect the board's USB-UART interface to a PC running a terminal emulation
   application such as HyperTerminal or PuTTY.
 - Execute the example software project.

The software will auto-negotiate an Ethernet link with the network's switch then
request an IP address from the DHCP server. It will display a message through a
UART onto the terminal emulator. The terminal emulator command line interface
will display the status of the link including the assigned IP address.

Once an IP address has been assigned to the board through DHCP, you can enter
the board's IP address into a web browser to view the web page generated by the
software executing on the SmartFusion2 Cortex-M3 processor.

The Ethernet link speed can be changed from the command line. 

--------------------------------------------------------------------------------
                             IP address assignment
--------------------------------------------------------------------------------
This example project can be built to use a dynamically assigned IP address using
DHCP or a static IP address. You need to ensure that the defined symbol
NET_USE_DHCP is defined in your project settings if you wish to use DHCP.
Otherwise, please refer to function prvEthernetConfigureInterface() in "main.c"
to select the static IP address you wish to use.

--------------------------------------------------------------------------------
                               UART configuration
--------------------------------------------------------------------------------
This example project requires MMUART0 to be connected to a host PC. The host PC
must connect to the serial port using a terminal emulator such as HyperTerminal
or PuTTY configured as follows:
    - 115200 baud
    - 8 data bits
    - 1 stop bit
    - no parity
    - no flow control

--------------------------------------------------------------------------------
                                Target hardware
--------------------------------------------------------------------------------
This example project is targeted at a SmartFusion2 design which has MMUART0
enabled and connected to a host PC. The example project is built for a design
using a SmartFusion2 MSS APB clock frequency of 50MHz. Trying to execute this
example project on a different design will result in incorrect baud rate being
used by MMUART0 or no output if MMUART0 is not enabled and connected.

This example project can be used with another design using a different clock
configuration. This can be achieved by overwriting the content of this example
project's "drivers_config/sys_config" folder with the one generated by Libero
as part of your design's creation.

The following jumpers must be closed when using this example project on the
SmartFusion2 Eval kit in order to connect the on board oscillator to SERDES 
reference clock pins
    J22: pins 1-2 
    J23: pins 1-2 

The hardware Libero design used for example uses MSS SERDES 0 interface to connect
with the on Board Marvel PHY. The Marvel PHY port0 (Phy Addr = 0x00) is used to
connect to the on board RJ45 connector J13.

--------------------------------------------------------------------------------
    Modifying this example to target other boards or interfaces
--------------------------------------------------------------------------------
Please refer to file lwip-1.4.1\netif\m2sxxx_ethernetif.c for modifying the
MSS MAC configuration. The following code in that file configures the MAC:

    MSS_MAC_cfg_struct_def_init(&g_mac_config);

    g_mac_config.phy_addr = M88E1340_PHY_ADDR;
    g_mac_config.speed_duplex_select = MSS_MAC_ANEG_ALL_SPEEDS;
    g_mac_config.mac_addr[0] = own_hw_adr[0];
    g_mac_config.mac_addr[1] = own_hw_adr[1];
    g_mac_config.mac_addr[2] = own_hw_adr[2];
    g_mac_config.mac_addr[3] = own_hw_adr[3];
    g_mac_config.mac_addr[4] = own_hw_adr[4];
    g_mac_config.mac_addr[5] = own_hw_adr[5];
    
    MSS_MAC_init(&g_mac_config);

    
You only need to modify these lines to use a different PHY or force the link
speed to a specific speed.

You will also need to remove the following comment from mscc_post_hw_cfg_init.c
file for SmartFusion2 Development kit(050):
    -- mscc_post_hw_cfg_init.c
    void mscc_post_hw_cfg_init(void)
    {
        //    configure_zl30362(); 
        ---
        ----
    }
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                          Silicon revision dependencies
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
This example is built to execute on an M2S090T die. You will need to overwrite
this example project's "drivers_config/sys_config" and "CMSIS" folders with the
one generated by Libero for your hardware design if using a newer silicon revision.
The "drivers_config/sys_config" folder contains information about your hardware
design. This information is used by the CMSIS to initialize clock frequencies
global variables which are used by the SmartFusion2 drivers to derive baud
rates. The CMSIS boot code may also complete the device's clock configuration
depending on silicon version. The "CMSIS" and "drivers_config/sys_config" for
your design can be found in the "firmware" folder of your Libero design.

